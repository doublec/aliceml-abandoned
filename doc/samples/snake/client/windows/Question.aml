(* Alice Snake 2.0 - QuestionWindow
*
*  Authors: Benedikt Grundmann / Sebastian Germesin
*
*  $Revision$
*
*  Last updated: $Date$ by $Author$
* 
*
*)

import signature QUESTION from "QUESTION-sig"

import structure Gtk      from "GtkSupport"


structure Question :> QUESTION =
struct

    type answers = {yes    : unit -> unit,
		    no     : unit -> unit,
		    cancel : unit -> unit }

    fun mkQuestionBox (parent, title, quest, {yes, no, cancel}) =
	let

	    val questionWindow = Gtk.windowNew Gtk.WINDOW_TOPLEVEL
	    val yesButton      = Gtk.buttonNewWithLabel "Yes"
	    val noButton       = Gtk.buttonNewWithLabel "No"
	    val buttonBox      = Gtk.hbuttonBoxNew ()
	    val dialogBox      = Gtk.vboxNew (false, 5)
	    val label          = Gtk.labelNew ""
		
	    fun question q = Gtk.labelSetText (label, q)


	    fun mainQuit ans = (Gtk.widgetDestroy questionWindow;
			        ans ())

	in

	    question quest;
	    Gtk.widgetSetParentWindow (questionWindow, parent);
	    Gtk.windowSetModal (questionWindow, true);
	    Gtk.containerSetBorderWidth (questionWindow, 10);
	    Gtk.windowSetTitle (questionWindow, title);
	    Gtk.windowSetPosition (questionWindow,
				   Gtk.WIN_POS_CENTER);
	    
	    Gtk.signalConnect (questionWindow, 
			       "delete-event",
			       fn _ => mainQuit cancel);
	    Gtk.signalConnect (yesButton, "clicked", 
			       fn _ => mainQuit yes);
	    Gtk.signalConnect (noButton, "clicked", 
			       fn _ => mainQuit no);
	    
	    Gtk.boxPackStart (buttonBox,
			      yesButton, true, true, 5);
	    Gtk.boxPackStart (buttonBox,
			      noButton, true, true, 5);
	    Gtk.boxPackStart (dialogBox,
			      label, false, false, 5);
	    Gtk.boxPackStart (dialogBox,
			      buttonBox, false, false, 5);

	    Gtk.containerAdd (questionWindow, dialogBox);

	    Gtk.widgetShowAll questionWindow
	end

end
